<div class="equipment-management-container">
  <h2>Gestione biciclette</h2>

  @if (errorMessage) {
    <div class="alert alert-danger">
      {{ errorMessage }}
    </div>
  }

  <div class="list-header-actions">
    <h3>Bicicletta corrente</h3>
    <button class="add-new-bike-button" (click)="openAddBikeModal()">
      <i class="fas fa-plus-circle"></i> Aggiungi una nuova bicicletta
    </button>
  </div>

  @if (bicycles?.length === 0 && !errorMessage) {
    <div class="no-data-message">Nessuna bicicletta trovata. Aggiungine una!</div>
  }
  @if (bicycles && bicycles.length > 0) {
    <table class="bicycle-table">
      <thead>
      <tr>
        <th>Identificativo Telaio</th>
        <th>Parcheggio</th>
        <th>Brand</th>
        <th>Modello</th>
        <th>Categoria</th>
        <th>Prezzo orario</th>
        <th>Stato</th>
      </tr>
      </thead>
      <tbody>
        @for (bicycle of bicycles; track bicycle.chassisId) {
          <tr>
            <td>{{ bicycle.chassisId }}</td>
            <td>{{ bicycle.currentParkingLotName }}</td>
            <td>{{ bicycle.brand }}</td>
            <td>{{ bicycle.model }}</td>
            <td>
              @if (bicycle.categories) {
                @for (cat of bicycle.categories; track cat) {
                  {{ cat }}{{ !$last ? ', ' : '' }}
                }
              }
            </td>
            <td>{{ bicycle.hourlyPrice | currency:'EUR':'symbol':'1.2-2' }}</td>
            <td>
              <span [ngClass]="{'status-available': bicycle.status === 'AVAILABLE', 'status-rented': bicycle.status === 'RENTED', 'status-maintenance': bicycle.status === 'UNDER_MAINTENANCE'}">
                {{ bicycle.status }}
              </span>
            </td>
          </tr>
        }
      </tbody>
    </table>
  }

  @if (showAddBikeModal) {
    <app-add-bike-modal
      [bicycleCategories]="bicycleCategories"
      (closeModalEvent)="closeAddBikeModal()"
      (addBikeEvent)="handleAddBike($event)">
    </app-add-bike-modal>
  }
</div>
